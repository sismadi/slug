<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<title>GitHub File Creator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: system-ui; background:#f4f6f8; padding:24px }
input, textarea, button {
  width:100%; padding:10px; margin:6px 0;
}
button {
  background:#24292e; color:#fff; border:0; cursor:pointer;
}
pre { background:#111827; color:#e5e7eb; padding:12px }
small { color:#6b7280 }
</style>
</head>
<body>

<h2>GitHub File Creator</h2>

<label>GitHub Token</label>
<input id="token" placeholder="ghp_xxxxx">

<label>Owner</label>
<input id="owner" placeholder="username">

<label>Repository</label>
<input id="repo" placeholder="repo-name">

<label>File Path</label>
<input id="path" placeholder="course/pemrograman-web/index.html">

<label>Commit Message</label>
<input id="message" value="create file">

<label>File Content</label>
<textarea id="content" rows="10">
<!doctype html>
<html><body><h1>Hello LMS</h1></body></html>
</textarea>

<button onclick="createFile()">Create / Update File</button>

<pre id="result"></pre>

<small>
⚠️ Token hanya disimpan di browser kamu.
</small>

<script>
async function createFile() {
  const token = tokenEl.value.trim();
  const owner = ownerEl.value.trim();
  const repo = repoEl.value.trim();
  const path = pathEl.value.trim();
  const message = msgEl.value;
  const content = btoa(unescape(encodeURIComponent(contentEl.value)));

  const url = `https://api.github.com/repos/${owner}/${repo}/contents/${path}`;

  // cek file sudah ada?
  let sha = null;
  const check = await fetch(url, {
    headers: { Authorization: `token ${token}` }
  });

  if (check.ok) {
    const data = await check.json();
    sha = data.sha;
  }

  const res = await fetch(url, {
    method: "PUT",
    headers: {
      Authorization: `token ${token}`,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      message,
      content,
      sha
    })
  });

  const result = await res.json();
  resultEl.textContent = JSON.stringify(result, null, 2);
}

const tokenEl = document.getElementById("token");
const ownerEl = document.getElementById("owner");
const repoEl = document.getElementById("repo");
const pathEl = document.getElementById("path");
const msgEl = document.getElementById("message");
const contentEl = document.getElementById("content");
const resultEl = document.getElementById("result");
</script>

</body>
</html>
